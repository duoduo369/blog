用邮箱扒头像
===

手上有几十万邮箱，本来用户系统没有做头像的东西，现在想根据这些邮箱能拿一部分用户的头像，可以直接使用
gravatar的服务，不过这玩意儿不时会被墙，还是拉回来靠谱，第2个途径是qq邮箱，通过分析数据发现，这几十万
用户里面居然有一半以上是qq邮箱，so 要想办法通过不用oauth的方式拿到.

思路与技术选择
---
作为一个pythoner，有很多爬虫框架可以选择，例如[scrapy](https://github.com/scrapy/scrapy) [pyspider 没错有中文 有ui 有时间调度](https://github.com/binux/pyspider)

但是扒图这种事情就是拿到url后直接抓回来就好, 没必要这么兴师动众，so requests就够了。

要做的事情
---

down回图，但是不要default的图片，例如qq的头像如果没有的话会给几种尺寸的默认图片，但是我不想要这个东西，没有就是没有

可以再扒图的进程挂掉后可以让他回复掉之前的现场(我可不想一次次重新抓, 几十万邮箱呢)

可以用多个进程，加快爬取速度

下面开始讲实现
---
第一步是获得url，如果你不介意gravatar会被墙，qq的连接会变(毕竟不是文档给出的地址), 这个地方就够了。

根据邮箱获得url
---

####gravatar

[gravatar文档](https://en.gravatar.com/site/implement/images/)

[gravatar python实现](https://en.gravatar.com/site/implement/images/python)

如需梯子请自备。

gravatar没什么可以说的，就是拿到md5后的qq邮箱

需要注意的参数 s是尺寸，gravatar做的比较好，基本什么尺寸都有
d是默认参数，不想用默认头像的时候填404，gravatar会返回404的响应, 其他参数请自己看文档

####qq

http://q4.qlogo.cn/g?b=qq&nk=491794128&s=1

qq连接则比较容易拿到(不要问我怎么找到的，我忘了)

nk是qq号，qq邮箱也可以

s为图片大小，我扒了一下发现里面有这么多的size尺寸 `1 2 3 4 5 40 41 100 140 160 240 640`,
1~5是都有的尺寸，其中2对应40*40, 4对应100*100, 但是请注意，不是每个人都有100大小的图(10年前传的头像，从来没改过，真的有这种用户, 我身边就有...)


![1](http://q4.qlogo.cn/g?b=qq&nk=491794128&s=1)
![2](http://q4.qlogo.cn/g?b=qq&nk=491794128&s=2)
![3](http://q4.qlogo.cn/g?b=qq&nk=491794128&s=3)
![4](http://q4.qlogo.cn/g?b=qq&nk=491794128&s=4)
![5](http://q4.qlogo.cn/g?b=qq&nk=491794128&s=5)


